<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Roblox Group Hub</title>
  <style>
    :root {
      --bg: #f8f9fa;
      --text: #222;
      --card-bg: #fff;
      --accent: #e74c3c;
      --shadow: rgba(0, 0, 0, 0.1);
    }

    body.dark {
      --bg: #1c1c1c;
      --text: #e0e0e0;
      --card-bg: #2c2c2c;
      --accent: #ff7675;
      --shadow: rgba(255, 255, 255, 0.1);
    }

    body {
      font-family: "Segoe UI", Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      text-align: center;
      padding: 80px 20px 40px;
      transition: background 0.3s, color 0.3s;
    }

    header.sticky {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: var(--card-bg);
      box-shadow: 0 2px 6px var(--shadow);
      padding: 0;
      z-index: 10;
    }

    .group-banner {
      width: 100%;
      height: 120px;
      background: linear-gradient(90deg, var(--accent), transparent);
      background-size: cover;
      background-position: center;
      border-radius: 0 0 10px 10px;
      filter: blur(2px) brightness(0.8);
    }

    .header-top {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
      padding: 15px 10px;
    }

    .group-icon {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid var(--accent);
      margin-right: 10px;
      transition: transform 0.2s;
    }

    .group-icon:hover {
      transform: scale(1.05);
    }

    #themeToggle {
      cursor: pointer;
      border: none;
      background: var(--accent);
      color: white;
      border-radius: 50%;
      width: 38px;
      height: 38px;
      font-size: 18px;
      transition: transform 0.2s;
    }

    #themeToggle:hover {
      transform: scale(1.1);
    }

    h1 {
      color: var(--accent);
      margin: 5px 0;
      font-size: 1.4em;
    }

    p {
      max-width: 600px;
      margin: 0 auto;
      line-height: 1.6;
      font-size: 0.95em;
    }

    .view-btn {
      display: inline-block;
      margin-top: 10px;
      padding: 10px 18px;
      background: var(--accent);
      color: white;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      transition: background 0.3s, transform 0.2s;
    }

    .view-btn:hover {
      background: #c0392b;
      transform: translateY(-2px);
    }

    .collapsible {
      margin: 20px auto;
      width: 100%;
      max-width: 800px;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: 0 2px 6px var(--shadow);
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .collapse-btn {
      background: var(--accent);
      color: white;
      font-size: 1em;
      border: none;
      width: 100%;
      text-align: left;
      padding: 15px 20px;
      cursor: pointer;
      outline: none;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .collapse-btn::after {
      content: "‚ñº";
      font-size: 0.9em;
      transition: transform 0.3s;
    }

    .collapse-btn.active::after {
      transform: rotate(180deg);
    }

    .content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease, padding 0.3s;
      padding: 0 20px;
    }

    .content.open {
      padding: 15px 20px 25px;
      max-height: 800px;
    }

    .controls {
      margin-bottom: 20px;
    }

    #searchBox,
    #roleFilter {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin: 5px;
      background: var(--card-bg);
      color: var(--text);
      width: 45%;
      max-width: 250px;
    }

    .member-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }

    .member-card {
      background: var(--card-bg);
      padding: 12px;
      border-radius: 10px;
      box-shadow: 0 2px 6px var(--shadow);
      transition: transform 0.2s;
    }

    .member-card:hover {
      transform: translateY(-3px);
    }

    .member-card img {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
    }

    .member-card h4 {
      margin: 10px 0 5px;
      font-size: 1em;
    }

    .member-card p {
      font-size: 0.85em;
      color: #999;
    }

    footer {
      margin-top: 40px;
      font-size: 0.9em;
      color: #777;
    }

    .loader {
      display: none;
      margin: 100px auto 20px;
      border: 6px solid #ccc;
      border-top: 6px solid var(--accent);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0); }
      100% { transform: rotate(360deg); }
    }

    @media (max-width: 600px) {
      h1 { font-size: 1.2em; }
      .group-banner { height: 80px; }
      .group-icon { width: 55px; height: 55px; }
      #themeToggle { width: 34px; height: 34px; }
      #searchBox, #roleFilter { width: 90%; }
    }
  </style>
</head>
<body>
  <header class="sticky">
    <div class="group-banner" id="groupBanner"></div>
    <div class="header-top">
      <img id="groupIcon" class="group-icon" src="" alt="Group Icon" />
      <div>
        <h1 id="groupName">Loading group...</h1>
        <p id="groupDesc">Please wait while we fetch your group info.</p>
        <a id="viewGroupBtn" href="#" target="_blank" class="view-btn">View on Roblox</a>
      </div>
      <button id="themeToggle">üåô</button>
    </div>
  </header>

  <div class="loader" id="loader"></div>

  <section class="collapsible shout">
    <button class="collapse-btn">üì¢ Group Shout</button>
    <div class="content">
      <p id="groupShout">Fetching shout...</p>
    </div>
  </section>

  <section class="collapsible members">
    <button class="collapse-btn">üë• Group Members</button>
    <div class="content">
      <div class="controls">
        <input id="searchBox" type="text" placeholder="üîé Search member by name..." />
        <select id="roleFilter">
          <option value="all">All Roles</option>
        </select>
      </div>
      <div id="memberList" class="member-grid">
        <p>Loading members...</p>
      </div>
    </div>
  </section>

  <footer>
    <p>Powered by Roblox Public API | Hosted on GitHub Pages</p>
  </footer>

  <script>
    const groupId = "36086667";
    const proxy = "https://api.allorigins.win/get?url=";
    let allMembers = [];
    let allRoles = [];

    async function fetchViaProxy(url) {
      const res = await fetch(proxy + encodeURIComponent(url));
      const data = await res.json();
      return JSON.parse(data.contents);
    }

    async function loadGroupData() {
      toggleLoader(true);
      try {
        const data = await fetchViaProxy(\`https://groups.roblox.com/v1/groups/\${groupId}\`);
        document.getElementById("groupName").textContent = data.name;
        document.getElementById("groupDesc").textContent = data.description;
        document.getElementById("viewGroupBtn").href = \`https://www.roblox.com/groups/\${groupId}\`;
        document.getElementById("groupShout").textContent = data.shout?.body || "No group shout at the moment.";

        // üñºÔ∏è Group icon & banner
        const iconData = await fetchViaProxy(\`https://thumbnails.roblox.com/v1/groups/icons?groupIds=\${groupId}&size=150x150&format=Png\`);
        const iconUrl = iconData.data?.[0]?.imageUrl;
        if (iconUrl) {
          document.getElementById("groupIcon").src = iconUrl;
          const banner = document.getElementById("groupBanner");
          banner.style.backgroundImage = \`url(\${iconUrl})\`;
        }

        await loadMembers();
      } catch (err) {
        document.getElementById("groupName").textContent = "Error loading group data";
        console.error("Failed to fetch group info:", err);
      }
      toggleLoader(false);
    }

    async function loadMembers() {
      const memberList = document.getElementById("memberList");
      memberList.innerHTML = "<p>Loading members...</p>";

      try {
        const rolesData = await fetchViaProxy(\`https://groups.roblox.com/v1/groups/\${groupId}/roles\`);
        allRoles = rolesData.roles;
        const roleFilter = document.getElementById("roleFilter");
        allRoles.forEach(role => {
          const opt = document.createElement("option");
          opt.value = role.name;
          opt.textContent = role.name;
          roleFilter.appendChild(opt);
        });

        const members = [];
        for (const role of allRoles) {
          const roleData = await fetchViaProxy(\`https://groups.roblox.com/v1/groups/\${groupId}/roles/\${role.id}/users?limit=10\`);
          roleData.data.forEach(u => members.push({ username: u.username, userId: u.userId, role: role.name }));
        }

        const ids = members.map(m => m.userId).join(",");
        const thumbs = await fetchViaProxy(\`https://thumbnails.roblox.com/v1/users/avatar-headshot?userIds=\${ids}&size=100x100&format=Png&isCircular=true\`);
        const thumbMap = {};
        thumbs.data.forEach(t => { thumbMap[t.targetId] = t.imageUrl; });

        allMembers = members.map(m => ({ ...m, avatar: thumbMap[m.userId] }));
        displayMembers(allMembers);
      } catch (err) {
        console.error("Error loading members:", err);
        memberList.innerHTML = "<p>Failed to load members.</p>";
      }
    }

    function displayMembers(members) {
      const memberList = document.getElementById("memberList");
      memberList.innerHTML = "";
      if (!members.length) {
        memberList.innerHTML = "<p>No members found.</p>";
        return;
      }
      members.forEach(member => {
        const card = document.createElement("div");
        card.classList.add("member-card");
        card.innerHTML = \`
          <img src="\${member.avatar}" alt="\${member.username}" />
          <h4>\${member.username}</h4>
          <p>\${member.role}</p>
        \`;
        memberList.appendChild(card);
      });
    }

    document.getElementById("searchBox").addEventListener("input", applyFilters);
    document.getElementById("roleFilter").addEventListener("change", applyFilters);

    function applyFilters() {
      const search = document.getElementById("searchBox").value.toLowerCase();
      const role = document.getElementById("roleFilter").value;
      const filtered = allMembers.filter(m =>
        (role === "all" || m.role === role) &&
        m.username.toLowerCase().includes(search)
      );
      displayMembers(filtered);
    }

    const themeToggle = document.getElementById("themeToggle");
    themeToggle.addEventListener("click", toggleTheme);

    function toggleTheme() {
      document.body.classList.toggle("dark");
      const isDark = document.body.classList.contains("dark");
      themeToggle.textContent = isDark ? "‚òÄÔ∏è" : "üåô";
      localStorage.setItem("theme", isDark ? "dark" : "light");
    }

    (function loadTheme() {
      const saved = localStorage.getItem("theme");
      if (saved === "dark") {
        document.body.classList.add("dark");
        themeToggle.textContent = "‚òÄÔ∏è";
      }
    })();

    function toggleLoader(show) {
      document.getElementById("loader").style.display = show ? "block" : "none";
    }

    document.querySelectorAll(".collapse-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        const content = btn.nextElementSibling;
        btn.classList.toggle("active");
        content.classList.toggle("open");
      });
    });

    loadGroupData();
  </script>
</body>
</html>
